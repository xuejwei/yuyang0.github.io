<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>scheme笔记</title>
<!-- 2013-07-14 Sun 18:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<meta name="author" content="Yu Yang"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/static/css/main.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body><div id="header">
<div id="header-top">
  <div id="blog-title">Yu Yang's Writing Time</div>
  <div id="blog-sub-title">something about my thinking, doing and reading notes...</div>
</div>
<div id="nav">
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/guestbook.html">留言板</a></li>
    <li><a href="/about.html">About Me</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li>
      <form action="/search.html">
        <input type="text" class="searchbox" name="wd" value="Search..." onblur="if(this.value==''){this.value='Search...';}" onfocus="if(this.value=='Search...'){this.value='';}"/>
        <input type="image" src="/static/img/google.ico" class="searchbox_submit" value="" />
      </form>
    </li>
  </ul>
  </div>
</div>

<div id="content">
<h1 class="title">scheme笔记</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">scheme笔记(the little schemer)</a>
<ul>
<li><a href="#sec-1-1">concepts</a>
<ul>
<li><a href="#sec-1-1-1">atom</a></li>
<li><a href="#sec-1-1-2">list</a></li>
<li><a href="#sec-1-1-3">S-expression</a></li>
<li><a href="#sec-1-1-4">Number</a></li>
<li><a href="#sec-1-1-5">arithmetic expression</a></li>
<li><a href="#sec-1-1-6">logcal expression</a></li>
<li><a href="#sec-1-1-7">condition expression</a></li>
<li><a href="#sec-1-1-8">多条表达式</a></li>
<li><a href="#sec-1-1-9">The Law of Car</a></li>
<li><a href="#sec-1-1-10">The Law of Cdr</a></li>
<li><a href="#sec-1-1-11">The Law of Cons</a></li>
<li><a href="#sec-1-1-12">The Law of Null?</a></li>
<li><a href="#sec-1-1-13">The Law of Eq?</a></li>
<li><a href="#sec-1-1-14">The primitive fuctions</a></li>
<li><a href="#sec-1-1-15">quote，引用</a></li>
</ul>
</li>
<li><a href="#sec-1-2">递归思想</a></li>
<li><a href="#sec-1-3">停机问题</a></li>
<li><a href="#sec-1-4">some example code</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">scheme笔记(the little schemer)</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">concepts</h3>
<div class="outline-text-3" id="text-1-1">
</div><div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">atom</h4>
<div class="outline-text-4" id="text-1-1-1">
<p class="verse">
a string of characters <br/>
a string of digits <br/>
&#xa0;<br/>
(quote atom) or 'atom <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">list</h4>
<div class="outline-text-4" id="text-1-1-2">
<p class="verse">
a collection of atoms enclosed by parentheses. <br/>
example: <br/>
'() <br/>
'(a) <br/>
'(a b c) <br/>
'((a b) c d) <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3">S-expression</h4>
<div class="outline-text-4" id="text-1-1-3">
<p class="verse">
all lists <br/>
all atoms <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4">Number</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>
we only use whole number
we only use nonegative integers
</p>
</div>
</div>

<div id="outline-container-sec-1-1-5" class="outline-4">
<h4 id="sec-1-1-5">arithmetic expression</h4>
<div class="outline-text-4" id="text-1-1-5">
<div class="org-src-container">

<pre class="src src-scheme"><span class="linenr">1: </span>(+ 1 2 3 4 5) <span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">return 15</span>
<span class="linenr">2: </span>(- 10 2 3)      <span style="color: #AEAEAE; font-style: italic;">;; </span><span style="color: #AEAEAE; font-style: italic;">return 5</span>
<span class="linenr">3: </span>(* 2 3 4)     <span style="color: #AEAEAE; font-style: italic;">;; </span><span style="color: #AEAEAE; font-style: italic;">return 24</span>
<span class="linenr">4: </span>(/ 10 5 5)    <span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">return 1</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-6" class="outline-4">
<h4 id="sec-1-1-6">logcal expression</h4>
<div class="outline-text-4" id="text-1-1-6">
<p class="verse">
and: (and &lt;p1&gt; &lt;p2&gt; &#x2026; &lt;pn&gt;) <br/>
or:  (or &lt;p1&gt; &lt;p2&gt; &#x2026;.&lt;pn&gt;) <br/>
not: (not &lt;p&gt;) <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-1-7" class="outline-4">
<h4 id="sec-1-1-7">condition expression</h4>
<div class="outline-text-4" id="text-1-1-7">
<div class="org-src-container">

<pre class="src src-scheme"><span class="linenr"> 1: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">var</span> 2)
<span class="linenr"> 2: </span>(<span style="color: #FBDE2D;">define</span> (<span style="color: #FF6400;">add</span> x y) (+ x y)
<span class="linenr"> 3: </span>  (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 4: </span>   (<span style="color: #8DA6CE;">&lt;p1&gt;</span> <span style="color: #8DA6CE;">&lt;e1&gt;</span>)
<span class="linenr"> 5: </span>   (<span style="color: #8DA6CE;">&lt;p2&gt;</span> <span style="color: #8DA6CE;">&lt;e2&gt;</span>)
<span class="linenr"> 6: </span>   (<span style="color: #8DA6CE;">&lt;p3&gt;</span> <span style="color: #8DA6CE;">&lt;e3&gt;</span>)
<span class="linenr"> 7: </span>   (<span style="color: #FBDE2D;">else</span> (else-clause))))
<span class="linenr"> 8: </span>(<span style="color: #FBDE2D;">define</span> (<span style="color: #FF6400;">abs</span> x)
<span class="linenr"> 9: </span>  (<span style="color: #FBDE2D;">cond</span>
<span class="linenr">10: </span>   (&lt; x 0) (- x)
<span class="linenr">11: </span>   (<span style="color: #FBDE2D;">else</span> x)))
<span class="linenr">12: </span>(<span style="color: #FBDE2D;">define</span> (<span style="color: #FF6400;">abs</span> x)
<span class="linenr">13: </span>  (<span style="color: #FBDE2D;">if</span> (&lt; x 0)
<span class="linenr">14: </span>      (- x)
<span class="linenr">15: </span>      x))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-8" class="outline-4">
<h4 id="sec-1-1-8">多条表达式</h4>
<div class="outline-text-4" id="text-1-1-8">
<p>
(begin &#x2026;.)
cond的body中有一个隐含的begin，所以cond中可以放多条表达式，而对于if则
必须使用begin明确的将多条表达式包含起来
</p>
</div>
</div>

<div id="outline-container-sec-1-1-9" class="outline-4">
<h4 id="sec-1-1-9">The Law of Car</h4>
<div class="outline-text-4" id="text-1-1-9">
<p>
The primitive Car is defined only for non­empty lists.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-10" class="outline-4">
<h4 id="sec-1-1-10">The Law of Cdr</h4>
<div class="outline-text-4" id="text-1-1-10">
<p>
The primitive cdr is defined only for non­empty lists.
The cdr of any non-empty list is always another list.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-11" class="outline-4">
<h4 id="sec-1-1-11">The Law of Cons</h4>
<div class="outline-text-4" id="text-1-1-11">
<p>
The primitive Cons takes two arguments.
The second argument to cons must be a list.
The result is a list.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-12" class="outline-4">
<h4 id="sec-1-1-12">The Law of Null?</h4>
<div class="outline-text-4" id="text-1-1-12">
<p>
The primitive null? is defined only for lists.(only (null? '()) return #t)
</p>
</div>
</div>

<div id="outline-container-sec-1-1-13" class="outline-4">
<h4 id="sec-1-1-13">The Law of Eq?</h4>
<div class="outline-text-4" id="text-1-1-13">
<p>
The primitive eq? takes two arguments.
Each must be a non-numeric atom.
</p>
</div>
</div>

<div id="outline-container-sec-1-1-14" class="outline-4">
<h4 id="sec-1-1-14">The primitive fuctions</h4>
<div class="outline-text-4" id="text-1-1-14">
<p class="verse">
number? <br/>
eq? <br/>
null? <br/>
zero? <br/>
car <br/>
cdr <br/>
cons <br/>
&#xa0;<br/>
atom? <b>(the three fuction below is defined by the book)</b> <br/>
add1 <br/>
sub1 <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-1-15" class="outline-4">
<h4 id="sec-1-1-15">quote，引用</h4>
<div class="outline-text-4" id="text-1-1-15">
<p>
first&#x2013;&#x2014;&gt; symbol(or a variable)
'first-&#x2014;&gt; an atom
'1 or 1&#x2014;&gt; a number
当调用函数时，先会对各个参数求值，所以每一个参数要么是atom，list或者一
个已经绑定的symbol
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">递归思想</h3>
<div class="outline-text-3" id="text-1-2">
<p class="verse">
递归的思想要从逻辑上理解，在设计一个递归函数时，一开始就要明确该函数在 <br/>
逻辑上的作用，然后分清该函数在逻辑上与子问题的联系，并以此为 依据来进 <br/>
行函数体的设计 <br/>
&#xa0;<br/>
递归函数的设计要点： <br/>
1. 要明确检查终止条件（null？ zero？） <br/>
2. 要明确与子问题的关系，弄清分类的情况（cond） <br/>
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">停机问题</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-scheme"><span class="linenr">1: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">last-try</span>
<span class="linenr">2: </span>  (<span style="color: #FBDE2D;">lambda</span> ( x )
<span class="linenr">3: </span>    (<span style="color: #FBDE2D;">and</span> ( will-stop ? last-try)
<span class="linenr">4: </span>         ( eternity x ))))
</pre>
</div>
<p>
上述代码会产生一个悖论，will-stop?:是否停机，eternity：会永远运行
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">some example code</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">

<pre class="src src-scheme"><span class="linenr">  1: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">test if x is a atom</span>
<span class="linenr">  2: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">atom?</span>
<span class="linenr">  3: </span>  (<span style="color: #FBDE2D;">lambda</span> (x)
<span class="linenr">  4: </span>    (<span style="color: #FBDE2D;">and</span> (not (pair? x))
<span class="linenr">  5: </span>         (not (null? x)))))
<span class="linenr">  6: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">add1</span>
<span class="linenr">  7: </span>  (<span style="color: #FBDE2D;">lambda</span>(x)
<span class="linenr">  8: </span>    (+ x 1)))
<span class="linenr">  9: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">sub1</span>
<span class="linenr"> 10: </span>  (<span style="color: #FBDE2D;">lambda</span> (x)
<span class="linenr"> 11: </span>    (- x 1)))
<span class="linenr"> 12: </span>
<span class="linenr"> 13: </span>
<span class="linenr"> 14: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">test if x is the member of lat(list)</span>
<span class="linenr"> 15: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">member?</span>
<span class="linenr"> 16: </span>  (<span style="color: #FBDE2D;">lambda</span> (x l)
<span class="linenr"> 17: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 18: </span>      ((null? l) #f)
<span class="linenr"> 19: </span>      (<span style="color: #FBDE2D;">else</span> (<span style="color: #FBDE2D;">or</span> (eq? x (car l))
<span class="linenr"> 20: </span>                (member? x (cdr l)))))))
<span class="linenr"> 21: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">test if the list is composed only of atom</span>
<span class="linenr"> 22: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">lat?</span>
<span class="linenr"> 23: </span>  (<span style="color: #FBDE2D;">lambda</span> (l)
<span class="linenr"> 24: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 25: </span>     ((null? l) #t)
<span class="linenr"> 26: </span>     ((atom? (car l)) (lat? (cdr l)))
<span class="linenr"> 27: </span>     (<span style="color: #FBDE2D;">else</span> #f))))
<span class="linenr"> 28: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">(firsts '((1 2 3) (a b c) (e f g)))</span>
<span class="linenr"> 29: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">return (1 a e)</span>
<span class="linenr"> 30: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">firsts</span>
<span class="linenr"> 31: </span>  (<span style="color: #FBDE2D;">lambda</span> (l)
<span class="linenr"> 32: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 33: </span>     ((null? l) '())
<span class="linenr"> 34: </span>     (<span style="color: #FBDE2D;">else</span> (cons (car (car l))
<span class="linenr"> 35: </span>                (firsts (cdr l)))))))
<span class="linenr"> 36: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">&#23558;new&#25554;&#20837;lat&#20013;&#31532;&#19968;&#20010;old&#30340;&#21518;&#38754;</span>
<span class="linenr"> 37: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">insertR</span>
<span class="linenr"> 38: </span>  (<span style="color: #FBDE2D;">lambda</span> (new old lat)
<span class="linenr"> 39: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 40: </span>     ((null? lat) '())
<span class="linenr"> 41: </span>     ((eq? old (car lat))
<span class="linenr"> 42: </span>      (cons old
<span class="linenr"> 43: </span>            (cons new
<span class="linenr"> 44: </span>                  (cdr lat))))
<span class="linenr"> 45: </span>     (<span style="color: #FBDE2D;">else</span> (cons (car lat) (insertR new old (cdr lat)))))))
<span class="linenr"> 46: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">&#23558;new&#25554;&#20837;lat&#20013;&#31532;&#19968;&#20010;lat&#30340;&#21069;&#38754;</span>
<span class="linenr"> 47: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">insertL</span>
<span class="linenr"> 48: </span>  (<span style="color: #FBDE2D;">lambda</span> (new old lat)
<span class="linenr"> 49: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 50: </span>     ((null? lat) '())
<span class="linenr"> 51: </span>     ((eq? old (car lat)) (cons new lat))
<span class="linenr"> 52: </span>     (<span style="color: #FBDE2D;">else</span> (cons (car lat) (insertL new old (cdr lat)))))))
<span class="linenr"> 53: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">&#23558;new&#25554;&#20837;lat&#20013;&#31532;&#25152;&#26377;old&#30340;&#21518;&#38754;</span>
<span class="linenr"> 54: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">multiinsertR</span>
<span class="linenr"> 55: </span>  (<span style="color: #FBDE2D;">lambda</span> (new old lat)
<span class="linenr"> 56: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 57: </span>     ((null? lat) '())
<span class="linenr"> 58: </span>     ((eq? old (car lat))
<span class="linenr"> 59: </span>      (cons old
<span class="linenr"> 60: </span>            (cons new (multiinsertR new old (cdr lat)))))
<span class="linenr"> 61: </span>     (<span style="color: #FBDE2D;">else</span> (cons (car lat) (multiinsertR new old (cdr lat)))))))
<span class="linenr"> 62: </span>
<span class="linenr"> 63: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">&#20197;*&#32467;&#23614;&#24847;&#21619;&#30528;&#23545;&#27599;&#19968;&#20010;&#20803;&#32032;&#36882;&#24402;</span>
<span class="linenr"> 64: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">(rember* 'aa '(aa (aa bb) (aa bb cc)))</span>
<span class="linenr"> 65: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">return ((bb) (bb cc))</span>
<span class="linenr"> 66: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">rember*</span>
<span class="linenr"> 67: </span>  (<span style="color: #FBDE2D;">lambda</span> (a l)
<span class="linenr"> 68: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 69: </span>     ((null? l) '())
<span class="linenr"> 70: </span>     ((atom? (car l))
<span class="linenr"> 71: </span>      (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 72: </span>       ((eq? a (car l)) (rember* a (cdr l)))
<span class="linenr"> 73: </span>       (<span style="color: #FBDE2D;">else</span> (cons (car l) (rember* a (cdr l))))))
<span class="linenr"> 74: </span>     (<span style="color: #FBDE2D;">else</span> (cons (rember* a (car l))
<span class="linenr"> 75: </span>                 (rember* a (cdr l)))))))
<span class="linenr"> 76: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">insertR*</span>
<span class="linenr"> 77: </span>  (<span style="color: #FBDE2D;">lambda</span> (new old lat)
<span class="linenr"> 78: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 79: </span>     ((null? lat) '())
<span class="linenr"> 80: </span>     ((atom? (car lat))
<span class="linenr"> 81: </span>      (<span style="color: #FBDE2D;">if</span> (eq? old (car lat))
<span class="linenr"> 82: </span>          (cons old (cons new
<span class="linenr"> 83: </span>                          (insertR* new old (cdr lat))))
<span class="linenr"> 84: </span>          (cons (car lat) (insertR*  new old (cdr lat)))))
<span class="linenr"> 85: </span>     (<span style="color: #FBDE2D;">else</span> (cons (insertR* new old (car lat))
<span class="linenr"> 86: </span>                 (insertR* new old (cdr lat)))))))
<span class="linenr"> 87: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">insertL*</span>
<span class="linenr"> 88: </span>  (<span style="color: #FBDE2D;">lambda</span> (new old lat)
<span class="linenr"> 89: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr"> 90: </span>     ((null? lat) '())
<span class="linenr"> 91: </span>     ((atom? (car lat)) (<span style="color: #FBDE2D;">if</span> (eq? old (car lat))
<span class="linenr"> 92: </span>                            (cons new (cons old
<span class="linenr"> 93: </span>                                            (insertL* new old (cdr
<span class="linenr"> 94: </span>                                                               lat))))
<span class="linenr"> 95: </span>                            (cons (car lat) (insertL* new old (cdr
<span class="linenr"> 96: </span>                                                               lat)))))
<span class="linenr"> 97: </span>     (<span style="color: #FBDE2D;">else</span> (cons (insertL* new old (car lat))
<span class="linenr"> 98: </span>                 (insertL* new old (cdr lat)))))))
<span class="linenr"> 99: </span>
<span class="linenr">100: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">lat&#20013;a&#20986;&#29616;&#30340;&#27425;&#25968;&#65292;&#22914;&#26524;lat&#30340;&#20803;&#32032;&#26102;list&#21017;&#36882;&#24402;</span>
<span class="linenr">101: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">occur*</span>
<span class="linenr">102: </span>  (<span style="color: #FBDE2D;">lambda</span> (a lat)
<span class="linenr">103: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr">104: </span>     ((null? lat) 0)
<span class="linenr">105: </span>     ((atom? (car lat)) (<span style="color: #FBDE2D;">if</span> (eq? a (car lat))
<span class="linenr">106: </span>                            (add1 (occur* a (cdr lat)))
<span class="linenr">107: </span>                            (occur* a (cdr lat))))
<span class="linenr">108: </span>     (<span style="color: #FBDE2D;">else</span> (+ (occur* a (car lat))
<span class="linenr">109: </span>              (occur* a  (cdr lat)))))))
<span class="linenr">110: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">eqlist</span>
<span class="linenr">111: </span>  (<span style="color: #FBDE2D;">lambda</span> (l1 l2)
<span class="linenr">112: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr">113: </span>     ((<span style="color: #FBDE2D;">and</span> (null? l1)
<span class="linenr">114: </span>           (null? l2)) #t)
<span class="linenr">115: </span>     ((<span style="color: #FBDE2D;">or</span> (null? l1)
<span class="linenr">116: </span>          (null? l2)) #f)
<span class="linenr">117: </span>     ((<span style="color: #FBDE2D;">and</span> (atom? (car l1))
<span class="linenr">118: </span>           (atom? (car l2)))
<span class="linenr">119: </span>           (<span style="color: #FBDE2D;">if</span> (eq? (car l1)
<span class="linenr">120: </span>                    (car l2))
<span class="linenr">121: </span>               (eqlist (cdr l1) (cdr l2))
<span class="linenr">122: </span>               #f))
<span class="linenr">123: </span>     ((<span style="color: #FBDE2D;">or</span> (atom? (car l1))
<span class="linenr">124: </span>          (atom? (car l2))) #f)
<span class="linenr">125: </span>     (<span style="color: #FBDE2D;">else</span> (<span style="color: #FBDE2D;">and</span> (eqlist (car l1) (car l2))
<span class="linenr">126: </span>                (eqlist (cdr l1) (cdr l2)))))))
<span class="linenr">127: </span><span style="color: #AEAEAE; font-style: italic;">;;</span><span style="color: #AEAEAE; font-style: italic;">&#38598;&#21512;&#25805;&#20316;</span>
<span class="linenr">128: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">intersect</span>
<span class="linenr">129: </span>  (<span style="color: #FBDE2D;">lambda</span> (set1 set2)
<span class="linenr">130: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr">131: </span>     ((null? set1) '())
<span class="linenr">132: </span>     ((member? (car set1) set2)
<span class="linenr">133: </span>      (cons (car set1)
<span class="linenr">134: </span>            (intersect (cdr set1) set2)))
<span class="linenr">135: </span>     (<span style="color: #FBDE2D;">else</span> (intersect (cdr set1) set2)))))
<span class="linenr">136: </span>
<span class="linenr">137: </span>(<span style="color: #FBDE2D;">define</span> <span style="color: #FF6400;">union</span>
<span class="linenr">138: </span>  (<span style="color: #FBDE2D;">lambda</span> (set1 set2)
<span class="linenr">139: </span>    (<span style="color: #FBDE2D;">cond</span>
<span class="linenr">140: </span>     ((null? set1) set2)
<span class="linenr">141: </span>     ((member? (car set1) set2)
<span class="linenr">142: </span>      (union (cdr set1) set2))
<span class="linenr">143: </span>     (<span style="color: #FBDE2D;">else</span> (cons (car set1)
<span class="linenr">144: </span>     (union (cdr set1) set2))))))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="disqus_comment">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        var url = window.location.pathname;
        var disqus_identifier = url.substring(url.lastIndexOf('/')+1);
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'yuyang'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
<!-- begin footer -->
<div id="footer">
  <hr />
  <ul class="links">
    <li>© 2013 Yu Yang's Blog, Created by org-mode and dropbox</li>
    <li><a href="/sitemap.tt">Sitemap</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about.html">About Me</a></li>
    <li><a href="#">Back to Top</a></li>
  </ul>
</div>
<!-- end footer --></body>
</html>
