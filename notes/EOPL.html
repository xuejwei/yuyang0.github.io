<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>The Essential of Programming language</title>
<!-- 2015-02-02 Mon 16:57 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Yu Yang" />
<meta  name="keywords" content="EOPL programming-language  scheme intepreter" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="static/css/main.css"/>
<link rel="shortcut icon" href="static/img/favicon.ico" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.bootcss.com/mathjax/2.4.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/javascript">window.MathJax || document.write('<script src="static/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" ><\/script>')</script>
<script type="text/javascript">

<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
            config: ["MMLorHTML.js"], jax: ["input/TeX"],
        //  jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<div id="header">
      <div class="inner">
        <h1 id="site-title"><a href="/"> 编码者言 </a></h1>
        <div>
          <a href="###" id="site-nav-btn">菜单</a>
          <ul id="site-nav" class="vertical-nav mobi-hid">
            <li> <a href="/">Home</a></li>
            <li> <a href="/about.html">About</a></li>

            <li> <a href="/tags.html">Tags</a></li>

            <li> <a href="/atom.xml">RSS</a></li>
          </ul>

          <form id="site-search" method="get" action="https://google.com/search">
            <input type="hidden" name="q" value="site:yuyang0.github.io" />
            <input type="text" name="q" placeholder="Search..." />
            <button class="btn-search" type="submit">Search</button>
          </form>
          <div style="clear:both;"> </div>
        </div>
      </div>
    </div>
</div>
<div id="content">
<h1 class="title">The Essential of Programming language</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Preface</a></li>
<li><a href="#sec-2">1. Inductive Sets and Data</a>
<ul>
<li><a href="#sec-2-1">1.1</a>
<ul>
<li><a href="#sec-2-1-1">top-down definition</a></li>
<li><a href="#sec-2-1-2">bottom-up definition</a></li>
<li><a href="#sec-2-1-3">rules of inference</a></li>
</ul>
</li>
<li><a href="#sec-2-2">1.2</a>
<ul>
<li><a href="#sec-2-2-1">用语法规则定义集合</a></li>
<li><a href="#sec-2-2-2">The Smaller-Subproblem Principle</a>
<ul>
<li><a href="#sec-2-2-2-1">nth-element</a></li>
<li><a href="#sec-2-2-2-2">remove-first</a></li>
<li><a href="#sec-2-2-2-3">occurs-free?</a></li>
<li><a href="#sec-2-2-2-4">subst</a></li>
</ul>
</li>
<li><a href="#sec-2-2-3">Follow the Grammar!</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">2 Data Abstraction</a>
<ul>
<li><a href="#sec-3-1">2.3 Interfaces for Recursive Data Types</a></li>
<li><a href="#sec-3-2">2.4 A Tool for Defining Recursive Data Types</a></li>
</ul>
</li>
<li><a href="#sec-4">3 Expressions</a>
<ul>
<li><a href="#sec-4-1">Some Concepts</a></li>
</ul>
</li>
<li><a href="#sec-5">4 State</a>
<ul>
<li><a href="#sec-5-1">返回值与副作用的区别</a></li>
<li><a href="#sec-5-2">difference between binding and assignments</a></li>
<li><a href="#sec-5-3">4.1 Computational Effects</a></li>
<li><a href="#sec-5-4">4.5 Parameter Passing Variations</a>
<ul>
<li><a href="#sec-5-4-1">Natural Parameter Passing</a></li>
<li><a href="#sec-5-4-2">Call By Reference</a></li>
<li><a href="#sec-5-4-3">Call By Value(CBV)</a></li>
<li><a href="#sec-5-4-4">Call By Name(CBN)</a></li>
<li><a href="#sec-5-4-5">Call By Need</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-6">5 Continuation-Passing Interpreter</a>
<ul>
<li><a href="#sec-6-1">Serveral Concepts</a></li>
</ul>
</li>
<li><a href="#lambda-calculus">lambda calculus</a>
<ul>
<li><a href="#sec-7-1">Terms</a></li>
<li><a href="#sec-7-2">Relations</a></li>
<li><a href="#sec-7-3">Normal Form</a></li>
<li><a href="#sec-7-4">Evaluation Strategy</a></li>
<li><a href="#sec-7-5">Church Encode</a>
<ul>
<li><a href="#sec-7-5-1">boolean</a></li>
<li><a href="#sec-7-5-2">pair</a></li>
<li><a href="#sec-7-5-3">number</a></li>
<li><a href="#sec-7-5-4">list</a></li>
</ul>
</li>
<li><a href="#sec-7-6">Y Combinator</a></li>
<li><a href="#sec-7-7">Theorems</a>
<ul>
<li><a href="#sec-7-7-1">Church-Rosser for =<sub>n</sub></a></li>
<li><a href="#sec-7-7-2">Diamond Property for →→<sub>n</sub></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-8">ISWIM</a>
<ul>
<li><a href="#sec-8-1">terms</a></li>
<li><a href="#sec-8-2">Values</a></li>
</ul>
</li>
<li><a href="#sec-9">Standard reduction</a></li>
<li><a href="#sec-10">Machines</a>
<ul>
<li><a href="#sec-10-1">CC Machine</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Preface</h2>
<div class="outline-text-2" id="text-1">
<blockquote>
<p>
  Perhaps the whole distinction between program and programming language is a
misleading idea, and future programmers will see themselves not as writing
programs in particular, but as creating new languages for each new application.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">1. Inductive Sets and Data</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">1.1</h3>
<div class="outline-text-3" id="text-2-1">
</div><div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1">top-down definition</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
自顶向下意味着从宏观的角度向微观细分
A Scheme list is a list of integers if and only if either
</p>
<ol class="org-ol">
<li>it is the empty list, or
</li>
<li>it is a pair whose car is an integer and whose cdr is a list of integers.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2">bottom-up definition</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
自底向上意味着从微观的角度向宏观归纳
The set List-of-Int is the smallest set of Scheme lists satisfying the
following two properties:
</p>
<ol class="org-ol">
<li>() ∈ List-of-Int, and
</li>
<li>if n ∈ Int and l ∈ List-of-Int, then (n . l) ∈ List-of-Int.
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-2-1-3" class="outline-4">
<h4 id="sec-2-1-3">rules of inference</h4>
<div class="outline-text-4" id="text-2-1-3">
\begin{align}
  () \in List-of-Int  \\
  \frac {n \in Int \quad l \in List-of-Int} {(n . l) \in List-of-Int}
\end{align}
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">1.2</h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1">用语法规则定义集合</h4>
<div class="outline-text-4" id="text-2-2-1">
\begin{align}
  List-of-Int &::= ()  \\
              &::= (Int . List-of-Int)
\end{align}

<p>
可以缩写为:
</p>
\begin{equation}
  List-of-Int ::= () | (Int . List-of-Int)
\end{equation}
</div>
</div>

<div id="outline-container-sec-2-2-2" class="outline-4">
<h4 id="sec-2-2-2">The Smaller-Subproblem Principle</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
If we can reduce a problem to a smaller subproblem, we can call the
procedure that solves the problem to solve the subproblem.
</p>
</div>
<div id="outline-container-sec-2-2-2-1" class="outline-5">
<h5 id="sec-2-2-2-1">nth-element</h5>
<div class="outline-text-5" id="text-2-2-2-1">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> <span style="color: #b58900;">nth-element</span>
  (<span style="color: #859900;">lambda</span> (lst n)
    (<span style="color: #859900;">if</span> (null? lst)
        (report-list-too-short n)
        (<span style="color: #859900;">if</span> (zero&#65311;n)
            (car lst)
            (nth-element (cdr lst) (- n 1))))))
(<span style="color: #859900;">define</span> <span style="color: #b58900;">report-list-too-short</span>
  (<span style="color: #859900;">lambda</span> (n)
    (eopl:error &#8217;nth-element
<span style="color: #2aa198;">"List too short by ~s elements.~%"</span> (+ n 1))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-2-2-2" class="outline-5">
<h5 id="sec-2-2-2-2">remove-first</h5>
<div class="outline-text-5" id="text-2-2-2-2">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> <span style="color: #b58900;">remove-first</span>
  (<span style="color: #859900;">lambda</span> (s los)
    (<span style="color: #859900;">if</span> (null? los)
        '()
        (<span style="color: #859900;">if</span> (eqv? s (car los))
            (cdr los)
            (cons (car los) (remove-first s (cdr los)))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-2-2-3" class="outline-5">
<h5 id="sec-2-2-2-3">occurs-free?</h5>
</div>
<div id="outline-container-sec-2-2-2-4" class="outline-5">
<h5 id="sec-2-2-2-4">subst</h5>
<div class="outline-text-5" id="text-2-2-2-4">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> <span style="color: #b58900;">subst</span>
  (<span style="color: #859900;">lambda</span> (new old slist)
    ()))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2-2-3" class="outline-4">
<h4 id="sec-2-2-3">Follow the Grammar!</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
When defining a procedure that operates on inductively defined data, the
structure of the program should be patterned after the structure of the
data.
</p>

<p>
更准确的说:
</p>
<ol class="org-ol">
<li>Write one procedure for each nonterminal in the grammar. The procedure
will be responsible for handling the data corresponding to that
nonterminal, and nothing else.
</li>
<li>In each procedure, write one alternative for each production correspond-
ing to that nonterminal. You may need additional case structure, but
this will get you started. For each nonterminal that appears in the
right-hand side, write a recursive call to the procedure for that
nonterminal.
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">2 Data Abstraction</h2>
<div class="outline-text-2" id="text-3">
<p>
\(\lceil v \rceil\) 代表数据 <code>v</code> 的实现
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">2.3 Interfaces for Recursive Data Types</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Designing an interface for a recursive data type:
</p>
<ol class="org-ol">
<li>Include one constructor for each kind of data in the data type.
</li>
<li>Include one predicate for each kind of data in the data type.
</li>
<li>Include one extractor for each piece of data passed to a constructor of
the data type.
</li>
</ol>
<p>
举个例子, 比如lambda calculus的语法定义是这样:
</p>
\begin{align}
  Lc-exp &::= Identifier \\
         &::= (lambda \ (Identifier) \ Lc-exp) \\
         &::= (Lc-exp \ Lc-exp)
\end{align}

<p>
我们来定义它的interface(<b>注意是接口,不是实现</b>).
</p>
<ol class="org-ol">
<li>Constructor
<ul class="org-ul">
<li>var-exp : Var → Lc-exp
</li>
<li>lambda-exp : Var × Lc-exp → Lc-exp
</li>
<li>app-exp : Lc-exp × Lc-exp → Lc-exp
</li>
</ul>
</li>
<li>Predicates
<ul class="org-ul">
<li>var-exp? : Lc-exp → Bool
</li>
<li>lambda-exp? : Lc-exp → Bool
</li>
<li>app-exp? : Lc-exp → Bool
</li>
</ul>
</li>
<li>Extractors
<ul class="org-ul">
<li><b>var-exp-&gt;var</b> :Lc-exp → Var
</li>
<li><b>lambda-exp-&gt;bound-var</b> :Lc-exp → Var
</li>
<li><b>lambda-exp-&gt;body</b> :Lc-exp → Lc-exp
</li>
<li><b>app-exp-&gt;rator</b> :Lc-exp → Lc-exp
</li>
<li><b>app-exp-&gt;rand</b> :Lc-exp → Lc-exp
</li>
</ul>
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">2.4 A Tool for Defining Recursive Data Types</h3>
<div class="outline-text-3" id="text-3-2">
<p>
使用define-datatype来自动的定义一个递归数据类型(<b>接口</b>),以lambda calculus的
语法定义为例子
</p>
<div class="org-src-container">

<pre class="src src-scheme">(define-datatype lc-exp lc-exp?
  (var-exp
   (var identifier?))
  (lambda-exp
   (bound-var identifier?)
   (body lc-exp?))
  (app-exp
   (rator lc-exp?)
   (rand lc-exp?)))
</pre>
</div>
<p>
上面声明了3个constructor: var-exp, lambda-exp, app-exp以及一个
predicate:Lc-exp?.然后可以使用cases来使用上述定义:
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> <span style="color: #b58900;">occurs-free?</span>
  (<span style="color: #859900;">lambda</span> (search-var exp)
    (cases lc-exp exp
           (var-exp (var) (eqv? var search-var))
           (lambda-exp (bound-var body)
                       (<span style="color: #859900;">and</span>
                        (not (eqv? search-var bound-var))
                        (occurs-free? search-var body)))
           (app-exp (rator rand)
                    (<span style="color: #859900;">or</span>
                     (occurs-free? search-var rator)
                     (occurs-free? search-var rand))))))
</pre>
</div>
<p>
使用cases可以匹配出一个lc-exp的类型,它到底是var-exp, lambda-exp还是app-exp,
根据不同的情况你可以分支处理,很像一个模式匹配的过程
</p>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">3 Expressions</h2>
<div class="outline-text-2" id="text-4">
<p>
本章的目的实际就是用scheme来写一个program来解释执行EOPL中let语言的AST,其实就
是写一个解释器,只是这个解释器直接接受AST,而不是字符串
</p>
</div>
<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Some Concepts</h3>
<div class="outline-text-3" id="text-4-1">
<ol class="org-ol">
<li>AST(aka: abstract syntax tree or just syntax tree): 抽象语法树,和Concrete
syntax tree(aka parse tree)像对应,AST不包含一些细节, 比如一个if表达式,在
AST就不会包含 if这样的关键词,因此无论你使用 if(..){..} 还是 if &#x2026; then
&#x2026; fi, 还是其他,它们的AST都是一样的
</li>
<li>scanning: 根据词法规则将字符串切分为一个一个的token
</li>
<li>parsing: 根据语法规则将scanning生成的token生成一个AST
</li>
<li>expressed value: 表达式的值
</li>
<li>denoted value: 变量所代表的值
</li>
<li>变量的声明与引用(declaration reference): lambda的形参是声明,let内的参数是
声明
</li>
<li>作用域(scope): 一个变量起作用的部分就是变量的作用域
</li>
<li>lexical depth: 词法深度,用来表示一个变量的引用与该变量声明之间的作用域的
个数,以0为开始
</li>
<li>identifiers: a identifier is a string of characters,typically letters or
digits,that refer to an entity,all identifiers are names,but not all
names are identifiers.
</li>
<li>name:
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">4 State</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">返回值与副作用的区别</h3>
<div class="outline-text-3" id="text-5-1">
<p>
   What’s the difference between producing a value and producing an effect?  An
effect is <b>global</b>: it is seen by the entire computation. An effect affects the
entire computation (pun intended).
</p>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">difference between binding and assignments</h3>
<div class="outline-text-3" id="text-5-2">
<p>
binding is local, but variable assignment is potentially global.
</p>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">4.1 Computational Effects</h3>
<div class="outline-text-3" id="text-5-3">
<p>
计算机内存可以抽象为一个 Map: locations ⟶ storable values
</p>
<ol class="org-ol">
<li>reference: 引用,(left value) A data structure represent location
</li>
<li>location: 包含reference指向的数据
</li>
<li>variable: One can think variable is same as location.
</li>
</ol>
<p>
二者的可以这样类比:reference可以看作是url,而location可以看作是文件,文件包含
数据,而url指向该文件
</p>

<div class="figure">
<p><img src="static/img/env-store.png" alt="env-store.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">4.5 Parameter Passing Variations</h3>
<div class="outline-text-3" id="text-5-4">
</div><div id="outline-container-sec-5-4-1" class="outline-4">
<h4 id="sec-5-4-1">Natural Parameter Passing</h4>
<div class="outline-text-4" id="text-5-4-1">
<p>
The denoted value is same as the expressed value of the actual
parameter.like the LET language
</p>
</div>
</div>
<div id="outline-container-sec-5-4-2" class="outline-4">
<h4 id="sec-5-4-2">Call By Reference</h4>
<div class="outline-text-4" id="text-5-4-2">
<p>
The Formal Parameter is associated with the same reference of the Actual
Parameter. so if you change the value of formal parameter, the value of
actual parameter also changes.
</p>

<div class="figure">
<p><img src="static/img/call-by-reference.png" alt="call-by-reference.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5-4-3" class="outline-4">
<h4 id="sec-5-4-3">Call By Value(CBV)</h4>
<div class="outline-text-4" id="text-5-4-3">
<p>
The denoted value is a reference to a location containning the expressed
value of the actual parameter.
</p>

<div class="figure">
<p><img src="static/img/call-by-value.png" alt="call-by-value.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5-4-4" class="outline-4">
<h4 id="sec-5-4-4">Call By Name(CBN)</h4>
</div>
<div id="outline-container-sec-5-4-5" class="outline-4">
<h4 id="sec-5-4-5">Call By Need</h4>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">5 Continuation-Passing Interpreter</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Serveral Concepts</h3>
<div class="outline-text-3" id="text-6-1">
<ol class="org-ol">
<li>Context: According to wikipedia, A task context is the minimal set of
data used by this task at the point it has been interrupted
</li>
<li>Data Context: Environment is the abstraction of Data Context
</li>
<li>Control Context: Continuation is the abstraction of Control Contextp
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-lambda-calculus" class="outline-2">
<h2 id="lambda-calculus"><a id="sec-7" name="sec-7"></a>lambda calculus</h2>
<div class="outline-text-2" id="text-lambda-calculus">
</div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Terms</h3>
<div class="outline-text-3" id="text-7-1">
<p>
The set of lambda-calculus expressions can be defined with following
grammar:
</p>
\begin{eqnarray*}
  M,N,L   &=& X  \\
          &|& (\lambda X.M)  \\
          &|& (M \ M)  \\
  X       &=& \textrm{a variable x,y ...}  \\

\end{eqnarray*}
</div>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2">Relations</h3>
<div class="outline-text-3" id="text-7-2">
<ol class="org-ol">
<li>FV: a relation(function) that maps a lambda calculus expression to a set
free variables.
\begin{eqnarray*}
  FV(X) &=& \{ X \}  \\
  FV( (\lambda X.M) ) &=& FV(M) / \{X \}  \\
  FV( (M_1 M_2) ) &=& FV(M_1) \cup FV(M_2)  \\

\end{eqnarray*}
</li>

<li>\(\_[\_ \leftarrow \_]\): a relation that maps a source expression, a
variable, and an argument expression to a target expression. The target
expression is the same as the source expression, except that free
instances of the variable are replaced by the argument expression:

\begin{eqnarray*}
  X_1[X_1 \leftarrow M]       &=& M     \\
  X_2[X_1 \leftarrow M]       &=& X_2    \\
  (\lambda X_1.M_1)[X_1 \leftarrow M_2]    &=& (\lambda X_1.M_1)   \\
  (\lambda X_1.M_1)[X_2 \leftarrow M_2]    &=& (\lambda X_3.M_1[X_1 \leftarrow X_3][X_2 \leftarrow M_2]) \\
                                             && where\ X_1 \neq X_2  \quad
                                             X_3 \notin FV(M_1) / \{X_1\} \quad
                                             X_3 \notin FV(M_2) \\
  (M_1 M_2)[X \leftarrow M_3]      &=& (M_1[X \leftarrow M_3] M_2[X \leftarrow M_3])\\

\end{eqnarray*}
</li>

<li>&alpha; conversion: a relation that maps a expression to another expression
with formal argument changed.
</li>
<li>&beta; reduction: the main reduction relation, encoding function application
</li>

<li>&eta; equivalence
\begin{eqnarray*}
  (\lambda X. M)        &\alpha&   (\lambda Y.M[X \leftarrow Y])   &where\ Y \notin FV(M) \\
  ((\lambda X.M_1) M2)   &\beta&    M_1[X \leftarrow M_2]         & \\
  (\lambda X.(M X))     &\eta&     M                              &where\ X \notin FV(M)  \\
\end{eqnarray*}
</li>

<li>\(n = \alpha \cup \beta \cup \eta\)
</li>
<li>\(\rightarrow_n^\alpha, \rightarrow_n^\beta, \rightarrow_n^\eta\) is the
compatiable closure of &alpha;, &beta;, &eta;.
</li>
<li>\(\twoheadrightarrow_n^\alpha, \twoheadrightarrow_n^\beta,
      \twoheadrightarrow_n^\eta\) is the flexive-transitive closure of
\(\rightarrow_n^\alpha, \rightarrow_n^\beta, \rightarrow_n^\eta\).
</li>
<li>\(=_n^\alpha, =_n^\beta, =_n^\eta\) is the symmetric closure of
\(\twoheadrightarrow_n^\alpha, \twoheadrightarrow_n^\beta,
      \twoheadrightarrow_n^\eta\), and the equivalence closure
\(\rightarrow_n^\alpha, \rightarrow_n^\beta, \rightarrow_n^\eta\).
</li>
<li>\(\rightarrow_n\): the compatiable closure of <b>n</b>.
</li>
<li>\(\twoheadrightarrow_n\): the reflexive-transitive closure of &rarr;<sub>n</sub>.
</li>
<li>=<sub>n</sub>: the symmetric closure of \(\twoheadrightarrow_n\), equivalence closure
of \(\rightarrow_n\).
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3">Normal Form</h3>
<div class="outline-text-3" id="text-7-3">
<p>
An expression is in normal form if it cann't be reduced by
\(\rightarrow_n^\beta\) or \(\rightarrow_n^\eta\).
</p>

<p>
not every lambda calculus expression has a normal form. for example:
</p>
\begin{displaymath}
  \Omega = ((\lambda x.x \ x) (\lambda x.x \ x))
\end{displaymath}

<p>
don't have normal form.
</p>
</div>
</div>
<div id="outline-container-sec-7-4" class="outline-3">
<h3 id="sec-7-4">Evaluation Strategy</h3>
<div class="outline-text-3" id="text-7-4">
<ol class="org-ol">
<li>full beta reduction: Any redex may be reduced at any time.
</li>
<li>Normal Order Strategy: The leftmoast outermost is always reduced
first.This Strategy can reduce the redex in the body of a function.
</li>
<li>Call By Name Strategy: Like Normal Order, but allows no reduction in the
body of function. <b>Call by Need</b> is optimizing version of Call by Name.
</li>
<li>Call by Value Strategy: Only Outermost redexs are reduced and where a
redex is reduced only when its right hand side has already been reduced
to a value.
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-7-5" class="outline-3">
<h3 id="sec-7-5">Church Encode</h3>
<div class="outline-text-3" id="text-7-5">
</div><div id="outline-container-sec-7-5-1" class="outline-4">
<h4 id="sec-7-5-1">boolean</h4>
<div class="outline-text-4" id="text-7-5-1">
\begin{eqnarray*}
  true &=& \lambda t. \lambda f.t   \\
  false &=& \lambda t.\lambda f.f    \\
  if &=& \lambda v. \lambda t.\lambda f. v\ t\ f  \\

  and &=& \lambda m.\lambda n. ((m\ n)\ false)      \\
  or &=& \lambda m.\lambda n.((m\ true)\ n)         \\
  not &=& \lambda m. if \ m \ false \ true
\end{eqnarray*}

<p>
lambda calculus is call by name. so ``if'' can be implemented as a function.
</p>
</div>
</div>
<div id="outline-container-sec-7-5-2" class="outline-4">
<h4 id="sec-7-5-2">pair</h4>
<div class="outline-text-4" id="text-7-5-2">
\begin{eqnarray*}
  mkpair &=& \lambda m.\lambda n. \lambda b. b\ m\ n   \\
  fst &=& \lambda p. p \ true   \\
  snd &=& \lambda p. p \ false
\end{eqnarray*}

<p>
b is true or false
</p>
</div>
</div>
<div id="outline-container-sec-7-5-3" class="outline-4">
<h4 id="sec-7-5-3">number</h4>
<div class="outline-text-4" id="text-7-5-3">
\begin{eqnarray*}
  zero &=& \lambda s.\lambda z. z     \\
  one &=& \lambda s.\lambda z.s\ z     \\
  two &=& \lambda s.\lambda z.s\ s\ z     \\
  ...                                 \\
  add1 &=& \lambda n. \lambda s.\lambda z. (s (n\ s\ z))  \\
  add &=& \lambda m. \lambda n. m\ add1\ n                \\
  add &=& \lambda m. \lambda n.\lambda s.\lambda z. m\ s (n\ s\ z) \\
  mul &=& \lambda m.\lambda n. m (add\ n) zero    \\

  zz &=& pair\ zero\ zero                         \\
  ss &=& \lambda p. mkpair (snd\ p) (add1 (snd\ p))    \\
  sub1 &=& \lambda n. fst (n\ ss\ zz)                 \\
  sub &=& \lambda m.\lambda n.\lambda s.\lambda z. n\ sub1\ m

\end{eqnarray*}

<p>
<code>s</code> means successor, <code>z</code> means zero. ``zero'' is same with ``false''.
</p>
</div>
</div>
<div id="outline-container-sec-7-5-4" class="outline-4">
<h4 id="sec-7-5-4">list</h4>
<div class="outline-text-4" id="text-7-5-4">
\begin{eqnarray*}
  [x, y, z] &=& \lambda c.\lambda n. (c\ x\ (c\ y\ (c\ z\ n)))         \\
  nil &=& \lambda c.\lambda n. n                       \\
  cons &=& \lambda e.\lambda l.\lambda c.\lambda n. (c\ e\ (l\ c\ n))   \\
  isnil &=& \lambda l. l (\lambda x. false) true                       \\
  head &=& \lambda l. l\ true\ true                 \\

  nn &=& (mkpair\ nil\ nil)                        \\
  ss &=& \lambda e.\lambda p. mkpair (snd\ p) (cons\ e\ (snd\ p)) \\
  tail &=& \lambda l. fst (l\ ss\ nn)
\end{eqnarray*}
</div>
</div>
</div>

<div id="outline-container-sec-7-6" class="outline-3">
<h3 id="sec-7-6">Y Combinator</h3>
<div class="outline-text-3" id="text-7-6">
<p>
假设要在lambda calculus中构造递归函数mul,那么最直观的想法就是:
</p>
\begin{displaymath}
  mult = \lambda n.\lambda m.if\ (iszero\ n)\ 0\ (add\ m\ (mult\ (sub1\ n)\ m))
\end{displaymath}

<p>
可是上述构造是不合法的,因为你不能在函数体引用你正在定义的函数, 所以函数体不
能有 <code>mult</code>:
</p>
\begin{displaymath}
  mkmult0 = \lambda t.\lambda n.\lambda m.if\ (iszero\ n)\ 0\ (add\ m\ (t\ (sub1\ n)\ m))
\end{displaymath}

<p>
假设我们已经构造出了mult,那么 (mkmult0 mult) 就是mult了, 可是实际上我们没有
构造出mult,所以mkmult0 仍然不能定义出mult, 同时应该看到一点: mult是mkmult0的
不动点,因此如果我们有一个算子可以求一个函数的不动点,那么就可以将这个算子应用
到 mkmult0 来得到 mult.
</p>

\begin{displaymath}
  mkmult1 = \lambda t.\lambda n.\lambda m.if\ (iszero\ n)\ 0\ (add\ m\ ((t\ t)\ (sub1\ n)\ m))
\end{displaymath}

<p>
(mkmult1 mkmult1)就是mult了,这就是一个定义递归函数的常用方法了,可是这个方法
比较笨拙,因为我们每一次调用必须将mkmult1应用于自身.更好的做法应该是能将自我
应用的部分提取出来,现在我们假设有一个 <code>mk</code> 函数
</p>
\begin{displaymath}
  mk = \lambda t.t\ (mk\ t)
\end{displaymath}

<p>
这个函数可以构造出mult: (mk mkmult0),可是 <code>mk</code> 的定义是递归的也犯了最开始定
义mul时同样的错误,所以我们使用 <code>mkmult1</code> 类似的方式来变换一下:
</p>
\begin{eqnarray*}
  mkmk &=& \lambda k.\lambda t.t ((k\ k)\ t)  \\
  mk   &=& (mkmk\ mkmk)
\end{eqnarray*}

<p>
因此我们得到了一个很重要的性质:
</p>
\begin{displaymath}
  (mkmult0\ (mk\ mkmult0)) = (mk\ mkmult0)
\end{displaymath}

<p>
那么 <code>(mk mkmult0)</code> 产生的函数就是 <code>mkmult0</code> 的不动点,而 <code>mk</code> 就是不动点算子,也
就是说将 <code>mk</code> 作用于一个函数就可以得到该函数的不动点, Y Combinator是一个更常
用的不动点算子:
</p>
\begin{displaymath}
  Y = \lambda f.(\lambda x.f\ (x\ x))\ (\lambda x.f\ (x\ x))
\end{displaymath}

<p>
这是一个Y combinator的推导过程(slideshare需翻墙):
</p>
<iframe src="http://www.slideshare.net/slideshow/embed_code/12319464"
width="427" height="356" frameborder="0" marginwidth="0" marginheight="0"
scrolling="no" style="border:1px solid #CCC;border-width:1px 1px
0;margin-bottom:5px" allowfullscreen> </iframe> <div
style="margin-bottom:5px"> <strong> <a
href="https://www.slideshare.net/yinwang0/reinventing-the-ycombinator"
title="Reinventing the Y combinator" target="_blank">Reinventing the Y
combinator</a> </strong> from <strong><a
href="http://www.slideshare.net/yinwang0" target="_blank">Ian
Wang</a></strong> </div>
</div>
</div>
<div id="outline-container-sec-7-7" class="outline-3">
<h3 id="sec-7-7">Theorems</h3>
<div class="outline-text-3" id="text-7-7">
</div><div id="outline-container-sec-7-7-1" class="outline-4">
<h4 id="sec-7-7-1">Church-Rosser for =<sub>n</sub></h4>
<div class="outline-text-4" id="text-7-7-1">
<p>
if M =<sub>n</sub> N, then there exists an L such that \(M \twoheadrightarrow_n L\) and
\(N \twoheadrightarrow_n L\).
</p>
</div>
</div>
<div id="outline-container-sec-7-7-2" class="outline-4">
<h4 id="sec-7-7-2">Diamond Property for →→<sub>n</sub></h4>
<div class="outline-text-4" id="text-7-7-2">
<p>
if \(L \twoheadrightarrow_n M\) and \(L \twoheadrightarrow_n N\) then there
exists an expression L1 such that \(M \twoheadrightarrow_n L1\) and \(N
    \twoheadrightarrow_n L1\)
</p>

<div class="figure">
<p><img src="static/img/diamond-property.png" alt="diamond-property.png" />
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">ISWIM</h2>
<div class="outline-text-2" id="text-8">
<p>
The difference between ISWIM and lambda calculus is that ISWIM uses Call By
Value evaluation strategy and it also contains some constants and primitive
operations.
</p>
</div>
<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">terms</h3>
<div class="outline-text-3" id="text-8-1">
\begin{eqnarray*}
    M, N, L, K  &=&  X      \\
                &|&  (\lambda X.M )  \\
                &|&  (M \ M)  \\
                &|&  b  \\
                &|&  (o^n \ M \ M ... M)  \\
    X           &=&  \textrm{a variable x, y, z ...}  \\
    b           &=&  \textrm{a basic constant}  \\
    o^n         &=&  \textrm{a n-ary primitive operation}  \\
\end{eqnarray*}
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">Values</h3>
<div class="outline-text-3" id="text-8-2">
\begin{eqnarray*}
    V,U,W   &=&  b                     &\textrm{;constant}  \\
            &|&  X                     &\textrm{;variable}  \\
            &|&  (\lambda X.M)                &\textrm{;function}  \\
\end{eqnarray*}
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Standard reduction</h2>
<div class="outline-text-2" id="text-9">
<ol class="org-ol">
<li>If the expression is an application and all components are values, then,
if the expression is a redex, it is the next redex to be reduced; if not,
the program cannot have a value.
</li>
<li>If the program is an application such that at least one of its
sub-expressions is not a value, pick the leftmost non-value and search for
a redex in there.
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10">Machines</h2>
<div class="outline-text-2" id="text-10">
</div><div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1">CC Machine</h3>
<div class="outline-text-3" id="text-10-1">
\begin{eqnarray*}
  \left\langle \left( M N \right), E \right\rangle  &
  \mapsto_{cc} & \left\langle M, E \left[ \left( \left[  \right] N
  \right) \right] \right\rangle\\
  \left\langle \left( V_1 N \right), E \right\rangle & \mapsto_{cc} &
  \left\langle N, E \left[ \left( V_1  \left[  \right] \right) \right]
  \right\rangle\\
  \left\langle \left( o^n V_1 \ldots V_i M N \ldots \right) , E
  \right\rangle & \mapsto_{cc} & \left\langle M, E \left[ \left( o^n
  V_1 \ldots V_i  \left[  \right] N \ldots \right) \right] \right\rangle\\
  \left\langle \left( \left( \lambda X.M \right) V \right), E \right\rangle &
  \mapsto_{cc} & \left\langle M \left[ X \leftarrow V \right], E
  \right\rangle\\
  \left\langle \left( o^m b_1 \ldots b_m \right), E \right\rangle &
  \mapsto_{cc} & \left\langle V, E \right\rangle\\
  \left\langle V, E \left[ \left( \left[  \right] N \right) \right]
  \right\rangle & \mapsto_{cc} & \left\langle \left( V N \right), E
  \right\rangle\\
  \left\langle V, E \left[ \left( U \left[  \right] \right) \right]
  \right\rangle & \mapsto_{cc} & \left\langle \left( U V \right), E
  \right\rangle\\
  \left\langle V, E \left[ \left( o^n V_1 \ldots V_i  \left[  \right] N \ldots
  \right) \right] \right\rangle & \mapsto_{cc} & \left\langle \left(
  o^n V_1 \ldots V_i V N \ldots \right) , E \right\rangle
\end{eqnarray*}
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<!-- 多说评论框 start -->
  <div id="duoshuo-id" class="ds-thread" data-thread-key="请将此处替换成文章在你的站点中的ID" data-title="请替换成文章的标题" data-url="请替换成文章的网址"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
   var url = window.location.pathname;
   var duoshuo_identifier = url.substring(url.lastIndexOf('/')+1);
   if (!!! duoshuo_identifier) {
     duoshuo_identifier = "index.html";
   }
   var title = document.title;
   var ele = document.getElementById("duoshuo-id");
   ele.setAttribute("data-thread-key", duoshuo_identifier);
   ele.setAttribute("data-title", title);
   ele.setAttribute("data-url", url);

</script>

<script type="text/javascript">
var duoshuoQuery = {short_name:"yuyang0"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end --><!-- begin footer -->
<div id="footer">
  <ul class="links vertical-nav">
    <li><a href="/sitemap.xml">Sitemap</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about.html">About Me</a></li>
    <li><a class="back-to-top" href="#">Back to Top</a></li>
  </ul>
  <span>© 2013 Yu Yang's Blog, Created by org-mode and dropbox</span>
  <a href="#" class="back-to-top" id="fixed-back-to-top" ></a>
</div>
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript">
	!window.jQuery && document.write('<script src="static/js/jquery-2.0.0.min.js"');></script>
	</script>
<script type="text/javascript" src="static/js/custom.js"></script>
<!-- end footer -->
</div>
</body>
</html>
