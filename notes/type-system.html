<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Type System</title>
<!-- 2014-03-26 Wed 14:14 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Yu Yang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="static/css/main.css"/> <link rel="shortcut icon" href="static/img/favicon.ico" />
<script type="text/javascript">window.MathJax || document.write('<script src="static/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" ><\/script>')</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
            config: ["MMLorHTML.js"], jax: ["input/TeX"],
        //  jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<div id="header">
      <div class="inner">
        <h1 id="blog-title"><a href="/"> Yu Yang's Blog</a></h1>
        <ul class="nav">
          <li> <a href="/">Home</a></li>
          <li> <a href="/about.html">About</a></li>
          <li> <a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" action="https://google.com/search" id="search">
          <input type="hidden" name="q" value="site:yuyang.farbox.com" />
          <input type="text" name="q" placeholder="Search..." />
        </form>
      </div>
    </div>
</div>
<div id="content">
<h1 class="title">Type System</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#type-system">Type System</a>
<ul>
<li><a href="#sec-1-1">Concepts</a></li>
<li><a href="#sec-1-2">Safety = Progress + Preservation</a></li>
<li><a href="#sec-1-3">Simple Typed Lambda Calculus</a>
<ul>
<li><a href="#sec-1-3-1">terms</a></li>
<li><a href="#sec-1-3-2">evaluation relation</a></li>
<li><a href="#sec-1-3-3">type relations</a></li>
</ul>
</li>
<li><a href="#sec-1-4">Types</a>
<ul>
<li><a href="#sec-1-4-1">base type</a></li>
<li><a href="#sec-1-4-2">Unit</a></li>
<li><a href="#sec-1-4-3">Function</a></li>
<li><a href="#sec-1-4-4">pairs</a></li>
<li><a href="#sec-1-4-5">tuples</a></li>
<li><a href="#sec-1-4-6">records</a></li>
<li><a href="#sec-1-4-7">sums</a></li>
<li><a href="#sec-1-4-8">variants</a></li>
<li><a href="#sec-1-4-9">Lists</a></li>
</ul>
</li>
<li><a href="#sec-1-5">Reference</a></li>
<li><a href="#sec-1-6">Subtype</a>
<ul>
<li><a href="#sec-1-6-1">function</a></li>
<li><a href="#sec-1-6-2">The Top and Bottom types</a></li>
</ul>
</li>
<li><a href="#sec-1-7">Polymorphism</a>
<ul>
<li><a href="#sec-1-7-1">Parameter Polymorphism</a></li>
<li><a href="#sec-1-7-2">Overload</a></li>
</ul>
</li>
<li><a href="#sec-1-8">Recursive Type</a>
<ul>
<li><a href="#sec-1-8-1">An Example(number list)</a></li>
<li><a href="#sec-1-8-2">fix combinator</a></li>
<li><a href="#sec-1-8-3">fold and unfold</a></li>
</ul>
</li>
<li><a href="#sec-1-9">Type Inference</a>
<ul>
<li><a href="#sec-1-9-1">Unification Algorithm</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-type-system" class="outline-2">
<h2 id="type-system"><a id="sec-1" name="sec-1"></a>Type System</h2>
<div class="outline-text-2" id="text-type-system">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Concepts</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li><b>type</b>: type is a name for a collection of values(actually it also
defines a collection of operations on these values). In general, if two
things below to two different types, they can't be the same.
</li>
<li><b>type system</b>: A type system is a set of types and the rules that gave
their use in programs.
</li>
<li><b>normal form</b>: A term is in normal form if no evaluation rule applies to
it. Every value is in normal form.but not every term in normal form is a
value.
</li>
<li><b>closed term</b>: A term without free variables is said to be closed.
</li>
<li><b>diverges</b>: if eval_v(M) does not exist, we say that M diverges.
</li>
<li><b>stuck</b>: A closed term is stuck if it is in normal form but not a value.
</li>
<li><b>redex</b>: reducible expression. One can think redex as the subexpression
reduced by evaluation relation.
</li>
<li><b>context</b>: The text surrounding a redex is its context.
</li>
<li><b>strict</b>: The arguments of a function are always evaluated whether they
are used by the body of the function. The call by value strategy is strict.
</li>
<li><b>non-strict(aka lazy)</b>: Evaluate only the arguments which are actually
used.The Call By Name and Call By Need strategy is non-strict.
</li>
<li><b>typeable(aka well-typed)</b>: A term <code>t</code> is well-typed if there is some T such
that <code>t:T</code>.
</li>
<li><b>safety(aka soundness)</b>: well-typed terms doesn't ``go wrong''.
</li>
<li><b>untyped language</b>: if a language only consists of an expression gammar
and a reduction relation, it is a untyped language.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Safety = Progress + Preservation</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>Progress: A well-typed term is not stuck (either it is a value or it can
take a step according to the evaluation rules).
</li>
<li>Preservation: If a well-typed term takes a step of evaluation, then the
resulting term is also well typed.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Simple Typed Lambda Calculus</h3>
<div class="outline-text-3" id="text-1-3">
</div><div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1">terms</h4>
<div class="outline-text-4" id="text-1-3-1">
\begin{eqnarray*}
  t ::= &                   &\textrm{terms}\\
        & x                 &\textrm{variable}\\
        & \lambda x:T.t     &\textrm{abstraction}\\
        & tt                &\textrm{application} \\
  v ::= &                   &\textrm{values} \\
        & \lambda x:T.t     &\textrm{abstraction value} \\
  T ::= &                   &\textrm{types} \\
        & T \rightarrow T   &\textrm{function type}\\
  \Gamma ::=&               &\textrm{type context}\\
            & \emptyset     &\textrm{empty context} \\
            & \Gamma , x:T  &\textrm{term variable binding}
\end{eqnarray*}

<ul class="org-ul">
<li><code>t</code> define the terms(expressions) of the STLC
</li>
<li><code>v</code> define the set of value(only contains function)
</li>
<li><code>T</code> define the set of type(only contains function type)
</li>
<li>\(\Gamma\) is the type context, also known as type environment.
</li>
<li>\(\vdash\) is a relation which maps a type environment and a term to a
type.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2">evaluation relation</h4>
<div class="outline-text-4" id="text-1-3-2">
\begin{eqnarray*}
  \frac{t_1 \rightarrow t_1^\prime}{t_1 t_2 \rightarrow t_1^\prime t_2} &\textrm{(E-APP1)}\\
  \frac{t_2 \rightarrow t_2^\prime}{v_1 t_2 \rightarrow v_1 t_2^\prime} &\textrm{(E-APP2)}\\
(\lambda x:T_{11}.t_{12})v_2 \rightarrow t_{12}[x \leftarrow v_2] &\textrm{(E-APPABS)}
\end{eqnarray*}
</div>
</div>
<div id="outline-container-sec-1-3-3" class="outline-4">
<h4 id="sec-1-3-3">type relations</h4>
<div class="outline-text-4" id="text-1-3-3">
\begin{eqnarray*}
  \frac{x:T \in \Gamma}{\Gamma \vdash x:T} &\textrm{(T-VAR)} \\
  \frac{\Gamma, x:T_1 \vdash t_2 : T_2}{\Gamma \vdash \lambda x:T_1.t_2 : T_2} &\textrm{(T-ABS)} \\
  \frac{\Gamma \vdash t_1 : T_1\rightarrow T_2 \qquad \Gamma \vdash t_2:T_1}{\Gamma \vdash t_1 t_2 :T_2} &\textrm{(T-APP)}
\end{eqnarray*}
</div>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">Types</h3>
<div class="outline-text-3" id="text-1-4">
<p>
STLC实际上限制了 lambda calculus 的表达能力,比如说在 STLC中不能定义递归函数,
不能编码 pair等等,但是为了给该语言添加这种表现力,我们可以直接向语言中添加一
些基本构造,比如为了定义递归函数,我们可以直接添加一个 <code>fix</code> 函数.为了编码
<code>pair</code> 我们可以直接将 mkpiar,fst,snd作为扩展添加进语言中.
</p>
</div>
<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1">base type</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
int, char, etc
</p>
</div>
</div>

<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2">Unit</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Unit type is another base type. statements or expressions which are used to
perform side affect return Unit type. One can think Unit type means no
type.
</p>
\begin{eqnarray*}
  \Gamma \vdash unit:Unit \\
  t_1;t_2 = (\lambda x:Unit. t_2) t_1 \qquad where x \notin \mathcal{FV}(t_2)
\end{eqnarray*}
</div>
</div>
<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3">Function</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
The type of a function should describe the type of the argument and the
type of the function body.
</p>

\begin{displaymath}
  \frac{\Gamma , x:T_1 \vdash t:T_2}{\Gamma \vdash \lambda x . t :T_2 \rightarrow T_2}
\end{displaymath}

<p>
One can think \(\rightarrow\) as a type constructor which consumes two types and
produces a function type.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4" class="outline-4">
<h4 id="sec-1-4-4">pairs</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
One can think pair as a special case of tuple which only has two
elements. The type rule of pair is as follows:
</p>

\begin{eqnarray*}
  t ::= &...                &\textrm{terms}\\
        & \{t, t\}          &\textrm{pair}\\
        & t.1               &\textrm{first projection}\\
        & t.2               &\textrm{second projection}\\
  v ::= &...                &\textrm{values}\\
        &\{v, v\}           &\textrm{pair value}\\
  T ::= &...                &\textrm{types}\\
        & T_1 \times T_2    &\textrm{pair type}
\end{eqnarray*}

<p>
evaluation rules:
</p>

\begin{eqnarray*}
  \{v_1, v_2\}.1 \rightarrow v_1 \\
  \{v_1, v_2\}.2 \rightarrow v_2 \\
  \frac{t \rightarrow t'}{t.1 \rightarrow t'.1} \\
  \frac{t \rightarrow t'}{t.2 \rightarrow t'.2} \\
  \frac{t_1 \rightarrow t_1'} {\{t_1, t_2\} \rightarrow \{t_1', t_2\}}  \\
  \frac{t_2 \rightarrow t_2'} {\{v_1, t_2\} \rightarrow \{v_1, t_2'\}}
\end{eqnarray*}

<p>
type rules
</p>
\begin{eqnarray*}
  \frac{\Gamma \vdash t_1:T_1 \qquad \Gamma \vdash t_2:T_2}{\Gamma \vdash \{t_1,t_2\}: T_1 \times T_2} &\textrm{(T-PAIR)}\\
  \frac{\Gamma \vdash t:T_1 \times T_2}{\Gamma \vdash t.1 : T_1} &\textrm{(T-PROJ1)}\\
  \frac{\Gamma \vdash t:T_1 \times T_2}{\Gamma \vdash t.2 : T_2} &\textrm{(T-PROJ2)}
\end{eqnarray*}
</div>
</div>
<div id="outline-container-sec-1-4-5" class="outline-4">
<h4 id="sec-1-4-5">tuples</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
t1:T1, t2:T2, t3:T3 ==&gt; (t1 t2 t3 &#x2026;.) : T1 * T2 * T3 * &#x2026;
</p>

<p>
The type of aa tuple can also write as: {T1 T2 T3 &#x2026;}
</p>

<p>
type rules:
</p>
\begin{eqnarray*}
  \frac{for each i \quad \Gamma \vdash t_i:T_i}{\Gamma \vdash \{t_i^{i\in 1..n}\}:\{T_i^{i \in 1..n}\}} &\textrm{(T-TUPLE)}\\
  \frac{\Gamma \vdash t:\{T_i^{i \in 1..n}\}}{\Gamma \vdash t.j:T_j} &\textrm{(T-PROJ)}
\end{eqnarray*}
</div>
</div>
<div id="outline-container-sec-1-4-6" class="outline-4">
<h4 id="sec-1-4-6">records</h4>
<div class="outline-text-4" id="text-1-4-6">
<p>
like the ``struct'' statement in C. every field has a name. while tuple uses
the index to fetch the field, record uses the name to fetch the field
</p>

<p>
{cost=30.27,partno=5524} : {cost:Float, partno:Int}
</p>
</div>
</div>

<div id="outline-container-sec-1-4-7" class="outline-4">
<h4 id="sec-1-4-7">sums</h4>
<div class="outline-text-4" id="text-1-4-7">
<p>
sums is a special case of variants which has only two variants.
</p>

<p>
T1 + T2
</p>
</div>
</div>

<div id="outline-container-sec-1-4-8" class="outline-4">
<h4 id="sec-1-4-8">variants</h4>
<div class="outline-text-4" id="text-1-4-8">
<p>
This data type has serveral variants. every variant is tagged with a
label. through these tags, we can use a case expression to deconstruct the
data type. this data type is also called disjoint Unions(not Union, Union
represents the untagged variant, like the ``union'' statement in C).
</p>

<p>
for example, the lambda expression type has three variants: identifier,
function expression and application expression, each also is a type. so you
can think the lambda expression type is the disjoint Unions of the three
types.because all the elements in this three types are also in lambda
expression types.
</p>

<p>
&lt;l1:T1, l2:T2, l3:T3 &#x2026;&gt;
</p>
</div>
</div>

<div id="outline-container-sec-1-4-9" class="outline-4">
<h4 id="sec-1-4-9">Lists</h4>
<div class="outline-text-4" id="text-1-4-9">
<p>
e1:T, e2:T, e3:T &#x2026; ==&gt; (e1 e2 e3 &#x2026;) : [T]
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">Reference</h3>
<div class="outline-text-3" id="text-1-5">
<p>
μ: the state of the store.
</p>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">Subtype</h3>
<div class="outline-text-3" id="text-1-6">
<p>
if S is the Subtype of T, any term of type S can safely be used in a
context where a term of type T is expected.
</p>

<p>
S &lt;: T  means S is the subtype of T, One can think the elements of S is a
subset of the elements of T.
</p>
</div>
<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1">function</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
The subtype rule of function type is as follows:
</p>

\begin{displaymath}
  \frac{T_1 <: S_1 \qquad S_2 <: T_2}{S_1 \rightarrow S_2 <: T_1 \rightarrow T_2}
\end{displaymath}

<p>
the inverse Lemma:
</p>

\begin{displaymath}
  \frac{S_1 \rightarrow S_2 <: T_1 \rightarrow T_2}{T_1 <: S_1 \qquad S_2 <: T_2}
\end{displaymath}
</div>
</div>
<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2">The Top and Bottom types</h4>
<div class="outline-text-4" id="text-1-6-2">
<ol class="org-ol">
<li><b>Top</b> is the super type of all the types
</li>
<li><b>Bot</b> is a subtype of every type
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">Polymorphism</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1">Parameter Polymorphism</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
这种多态一般意味着: 函数不需要知道参数的具体类型, 比如说haskell 中的一个计
算list长度的函数length,length的类型很显然是 \([\alpha] \rightarrow int\), length并不需要知道参
数到底是[int],[char]或者[float], length对于这些类型都是同一种操作方式
</p>

<p>
就像使用 \(\lambda\) 来提供抽象,使得我们可以定义函数,而这个函数可以对不同的
value作出反应, 对type我们也可以采用类似的方法.以swap函数为例,它会交换一个
pair中first与second位置的元素, swap的定义如下:
</p>

\begin{displaymath}
  swap = \Lambda \alpha . \Lambda \beta . \lambda p : (\alpha \times \beta) . \langle snd \  p , fst \  p \rangle
\end{displaymath}

<p>
该函数的类型如下:
</p>

\begin{displaymath}
  \vdash swap : (\forall \alpha . (\forall \beta . ((\alpha \times \beta) \rightarrow (\beta \times \alpha))))
\end{displaymath}
</div>
</div>
<div id="outline-container-sec-1-7-2" class="outline-4">
<h4 id="sec-1-7-2">Overload</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
这种多态对不同的类型有不同的操作方式,比如haskell的 <code>+</code> 操作,该操作可以应用
于int, float等等, 但是对于每一种类型它都有一套特有的操作方式,也就是需要重载.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8">Recursive Type</h3>
<div class="outline-text-3" id="text-1-8">
</div><div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1">An Example(number list)</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
An number list is either
</p>
<ul class="org-ul">
<li>null or
</li>
<li>(cons n l) where n is a number and l is a list of number.
</li>
</ul>
<p>
what is the type of the number list? The \(List_{num}\) must obey the
following equation:
</p>

\begin{displaymath}
  List_{num} = (bool + (num \times List_{num}))
\end{displaymath}

<p>
but like the recusive function, you can't reference the type itself when
you define it. so you can't use \(List_{num}\) on the right side of the
equation. but we can use the same skill like we define the recusive
function: we can define tfix(the type fix combinator), so the \(List_{num}\)
can define like this:
</p>

\begin{displaymath}
  List_{num} \dot{=}_{} tfix(\forall \alpha .(bool + (num \times \alpha)))
\end{displaymath}

<p>
by convention a tfix an its following \(\forall\) are collapsed together to a
single \(\mu\), \(\mu\) is a explicit recursive operator for types. one can
think \(\mu\) is like letrec.
</p>

\begin{displaymath}
  List_{num} \dot{=}_{} \mu \alpha(bool + (num \times \alpha))
\end{displaymath}

<p>
a type constructed by \(\mu\) is a <b>recursive type</b>.
</p>
</div>
</div>

<div id="outline-container-sec-1-8-2" class="outline-4">
<h4 id="sec-1-8-2">fix combinator</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
fix(T) = λf:T⟶T.(λx:(μA.A⟶T) .f (x x)) (λx:(μA.A⟶T). f (x x))
</p>
</div>
</div>

<div id="outline-container-sec-1-8-3" class="outline-4">
<h4 id="sec-1-8-3">fold and unfold</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
In many language, there is no explicit <code>fold</code> and <code>unfold</code> keyword. instead
each use of a constructor to create a value implies a <code>fold</code>, and each use
of a constructor in a pattern match implies <code>unfold</code>. The type rules for
<code>fold</code> and <code>unfold</code> is as follows:
</p>
\begin{displaymath}
  \frac{\Gamma \vdash M:T[A \leftarrow (\mu A.T)]}{\Gamma \vdash (fold \ M) : (\mu A.T)}
  \qquad
  \frac{\Gamma \vdash M:(\mu A.T)}{\Gamma \vdash (unfold \ M) : T[A \leftarrow (\mu A.T)]}
\end{displaymath}

\begin{eqnarray}
  List_\tau &\dot{=}& \mu \alpha . (bool + (\tau \times \alpha)) \\
  UList_\tau &\dot{=}& (bool + (\tau \times List_\tau))
\end{eqnarray}
</div>
</div>
</div>
<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9">Type Inference</h3>
<div class="outline-text-3" id="text-1-9">
</div><div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1">Unification Algorithm</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
unification consumes a set of constraints and either:
</p>
<ul class="org-ul">
<li>identifies inconsistencies amongst the constraints or
</li>
<li>generate a substitution that represent the solution of the constraints.
</li>
</ul>

<p>
The algorithm is as follows(Assume the constraint has the form: X=Y):
</p>
<ol class="org-ol">
<li>Push all the constraints to a stack and generate an empty substitution.
</li>
<li>If X and Y are identical identifiers, do nothing.
</li>
<li>If X is an identifier, replace all occurrences of X by Y both on the
stack and in the substitution, and add X → Y to the substitution.
</li>
<li>If Y is an identifier, replace all occurrences of Y by X both on the
stack and in the substitution, and add Y → X to the substitution.
</li>
<li>If X is of the form C(X1 , . . . , Xn ) for some constructor C,4 and Y
is of the form C(Y1 , . . . ,Yn ) (i.e., it has the same constructor),
then push Xi = Yi for all 1 ≤ i ≤ n onto the stack.
</li>
<li>Otherwise, X and Y do not unify. Report an error.  Does this this
algorithm terminate? On every iteration of the mai
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="disqus_comment">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        var url = window.location.pathname;
        var disqus_identifier = url.substring(url.lastIndexOf('/')+1);
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'yuyang'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<!-- begin footer -->
<div id="footer">
  <hr />
  <ul class="links">
    <li>© 2013 Yu Yang's Blog, Created by org-mode and dropbox</li>
    <li><a href="/sitemap.xml">Sitemap</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about.html">About Me</a></li>
    <li><a href="#">Back to Top</a></li>
  </ul>
</div>
<!-- end footer -->
</div>
</body>
</html>
